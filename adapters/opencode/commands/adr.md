---
description: 创建新的 ADR（架构决策记录），自动编号、填充模板、更新索引
argument-hint: [决策标题]
---

你是文档体系的 ADR 创建助手。

## Step 1: 确定 ADR 编号

扫描 `docs/adr/` 目录下所有 `NNNN-*.md` 文件（排除 TEMPLATE.md），找到最大编号 +1。
目录为空则从 0001 开始。

## Step 2: 确定标题

- 如果 `$ARGUMENTS` 提供了标题，直接使用
- 否则询问用户：这个 ADR 要记录什么决策？

## Step 3: 收集内容

逐步引导用户填写：

1. **背景**：为什么需要做这个决策？
2. **方案对比**：有哪些可选方案？各自优劣？（至少 2 个）
3. **决策**：最终选择了哪个方案？为什么？
4. **后果**：正面和负面影响？

## Step 4: 创建 ADR 文件

文件路径：`docs/adr/NNNN-简短标题.md`

内容格式：

```
# ADR-NNNN: [标题]

- **状态**：已采纳
- **日期**：[今天日期 YYYY-MM-DD]
- **关联**：[如有关联 ADR]

## 背景
[用户提供的背景]

## 方案对比
| 方案 | 优势 | 劣势 |
|------|------|------|
| [方案A] | [优势] | [劣势] |
| [方案B] | [优势] | [劣势] |

## 决策
[决策和理由]

## 后果
[正面和负面影响]
```

## Step 5: 更新 docs/INDEX.md

在"技术决策 (ADR)"章节追加：
`- [ADR-NNNN 标题](adr/NNNN-标题.md) — 一句话摘要`

## Step 6: 同步 .agent/decisions.md

追加：`- **[标题]**: 选择了什么 → ADR-NNNN`

## 输出确认

```
ADR 创建完成：docs/adr/NNNN-标题.md
INDEX.md ✓  decisions.md ✓
```
